{"ast":null,"code":"// const mysql = require('serverless-mysql')\n// const db = mysql({\n//   config: {\n//     host: process.env.MYSQL_HOST,\n//     database: process.env.MYSQL_DATABASE,\n//     user: process.env.MYSQL_USER,\n//     password: process.env.MYSQL_PASSWORD,\n//   },\n// })\n// const client = new ServerlessClient({\n//     user: process.env.DB_USER,\n//     host: process.env.DB_HOST,\n//     database: process.env.DB_NAME,\n//     password: process.env.DB_PASSWORD,\n//     // port: process.env.DB_PORT\n// });\nimport ServerlessClient from 'serverless-postgres';\nconsole.log(ServerlessClient);\nconst hostname = '127.0.0.1';\nconst port = 7000; // const doConnect = async () => {\n//     try {\n//         const client = new ServerlessClient({\n//         user: process.env.DB_USER,\n//         host: \"localhost\",\n//         database: process.env.DB_NAME,\n//         password: process.env.DB_PASSWORD,\n//         //   port: process.env.DB_PORT\n//         });\n//         console.log({\n//             user,\n//             host,\n//             database,\n//             password,\n//             port\n//         })\n//         await client.sconnect();\n//         await client.query(`SELECT NOW()`);\n//         console.log(\"connection ok\");\n//         await client.clean();\n//     } catch (e) {\n//         console.log(e.message);\n//     }\n// }\n// doConnect()\n\nexports.query = async query => {\n  try {\n    const db = new ServerlessClient({\n      host: process.env.DB_HOST,\n      database: process.env.DB_NAME,\n      user: process.env.DB_USER,\n      password: process.env.DB_PASSWORD\n    });\n    const results = await db.query(query);\n    await db.end();\n    return results;\n  } catch (error) {\n    return {\n      error\n    };\n  }\n};","map":{"version":3,"sources":["/home/hnd/ws/learn/amplify/nextjs/next-mysql/lib/db.js"],"names":["ServerlessClient","console","log","hostname","port","exports","query","db","host","process","env","DB_HOST","database","DB_NAME","user","DB_USER","password","DB_PASSWORD","results","end","error"],"mappings":"AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,gBAAP,MAA6B,qBAA7B;AACAC,OAAO,CAACC,GAAR,CAAYF,gBAAZ;AAGA,MAAMG,QAAQ,GAAG,WAAjB;AACA,MAAMC,IAAI,GAAG,IAAb,C,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEAC,OAAO,CAACC,KAAR,GAAgB,MAAOA,KAAP,IAAiB;AAC/B,MAAI;AACF,UAAMC,EAAE,GAAG,IAAIP,gBAAJ,CAAqB;AAC5BQ,MAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC,OADU;AAE5BC,MAAAA,QAAQ,EAAEH,OAAO,CAACC,GAAR,CAAYG,OAFM;AAG5BC,MAAAA,IAAI,EAAEL,OAAO,CAACC,GAAR,CAAYK,OAHU;AAI5BC,MAAAA,QAAQ,EAAEP,OAAO,CAACC,GAAR,CAAYO;AAJM,KAArB,CAAX;AAMA,UAAMC,OAAO,GAAG,MAAMX,EAAE,CAACD,KAAH,CAASA,KAAT,CAAtB;AACA,UAAMC,EAAE,CAACY,GAAH,EAAN;AACA,WAAOD,OAAP;AACD,GAVD,CAUE,OAAOE,KAAP,EAAc;AACd,WAAO;AAAEA,MAAAA;AAAF,KAAP;AACD;AACF,CAdD","sourcesContent":["// const mysql = require('serverless-mysql')\n\n// const db = mysql({\n//   config: {\n//     host: process.env.MYSQL_HOST,\n//     database: process.env.MYSQL_DATABASE,\n//     user: process.env.MYSQL_USER,\n//     password: process.env.MYSQL_PASSWORD,\n//   },\n// })\n\n// const client = new ServerlessClient({\n//     user: process.env.DB_USER,\n//     host: process.env.DB_HOST,\n//     database: process.env.DB_NAME,\n//     password: process.env.DB_PASSWORD,\n//     // port: process.env.DB_PORT\n// });\n\nimport ServerlessClient from 'serverless-postgres'\nconsole.log(ServerlessClient)\n\n\nconst hostname = '127.0.0.1';\nconst port = 7000;\n// const doConnect = async () => {\n//     try {\n//         const client = new ServerlessClient({\n//         user: process.env.DB_USER,\n//         host: \"localhost\",\n//         database: process.env.DB_NAME,\n//         password: process.env.DB_PASSWORD,\n//         //   port: process.env.DB_PORT\n//         });\n\n//         console.log({\n//             user,\n//             host,\n//             database,\n//             password,\n//             port\n//         })\n\n//         await client.sconnect();\n//         await client.query(`SELECT NOW()`);\n//         console.log(\"connection ok\");\n//         await client.clean();\n//     } catch (e) {\n//         console.log(e.message);\n//     }\n// }\n  \n// doConnect()\n\nexports.query = async (query) => {\n  try {\n    const db = new ServerlessClient({\n        host: process.env.DB_HOST,\n        database: process.env.DB_NAME,\n        user: process.env.DB_USER,\n        password: process.env.DB_PASSWORD,\n    })\n    const results = await db.query(query)\n    await db.end()\n    return results\n  } catch (error) {\n    return { error }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}